<svg viewBox="0 0 900 800" xmlns="http://www.w3.org/2000/svg">
  <style>
    .box { fill: #e3f2fd; stroke: #1976d2; stroke-width: 2; }
    .text { fill: #333; font-family: Arial, sans-serif; font-size: 14px; }
    .arrow { stroke: #666; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    .note { fill: #fff3e0; stroke: #f57c00; stroke-width: 1; }
    .highlight { fill: #ffebee; stroke: #d32f2f; stroke-width: 2; }
  </style>
  
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <polygon points="0,0 10,5 0,10" fill="#666"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text class="text" x="450" y="30" text-anchor="middle" font-size="18" font-weight="bold">CoT Mirage Hacking Pipeline</text>
  
  <!-- Step 1 -->
  <rect class="highlight" x="50" y="60" width="200" height="60" rx="5"/>
  <text class="text" x="150" y="85" text-anchor="middle" font-weight="bold">1. Harmful Prompt</text>
  <text class="text" x="150" y="105" text-anchor="middle">Input harmful request</text>
  
  <line class="arrow" x1="250" y1="90" x2="290" y2="90"/>
  
  <!-- Step 2 -->
  <rect class="box" x="290" y="60" width="200" height="60" rx="5"/>
  <text class="text" x="390" y="85" text-anchor="middle" font-weight="bold">2. Generate Harmful CoT</text>
  <text class="text" x="390" y="105" text-anchor="middle">LLM rejects with reasoning</text>
  
  <line class="arrow" x1="490" y1="90" x2="530" y2="90"/>
  
  <!-- Step 3 -->
  <rect class="box" x="530" y="60" width="200" height="60" rx="5"/>
  <text class="text" x="630" y="85" text-anchor="middle" font-weight="bold">3. Analyze &amp; Generate</text>
  <text class="text" x="630" y="105" text-anchor="middle">Word Mapping</text>
  
  <line class="arrow" x1="630" y1="120" x2="630" y2="160"/>
  
  <!-- Step 4 -->
  <rect class="box" x="530" y="160" width="200" height="60" rx="5"/>
  <text class="text" x="630" y="185" text-anchor="middle" font-weight="bold">4. Create Safe Prompt</text>
  <text class="text" x="630" y="205" text-anchor="middle">Replace harmful words</text>
  
  <line class="arrow" x1="630" y1="220" x2="630" y2="260"/>
  
  <!-- Step 5 -->
  <rect class="box" x="530" y="260" width="200" height="60" rx="5"/>
  <text class="text" x="630" y="285" text-anchor="middle" font-weight="bold">5. Generate Safe CoT</text>
  <text class="text" x="630" y="305" text-anchor="middle">LLM reasons helpfully</text>
  
  <line class="arrow" x1="630" y1="320" x2="630" y2="360"/>
  
  <!-- Step 6 -->
  <rect class="box" x="530" y="360" width="200" height="60" rx="5"/>
  <text class="text" x="630" y="385" text-anchor="middle" font-weight="bold">6. Truncate CoT</text>
  <text class="text" x="630" y="405" text-anchor="middle">Keep reasoning, remove details</text>
  
  <line class="arrow" x1="530" y1="390" x2="490" y2="390"/>
  
  <!-- Step 7 -->
  <rect class="box" x="290" y="360" width="200" height="60" rx="5"/>
  <text class="text" x="390" y="385" text-anchor="middle" font-weight="bold">7. Refine Mappings</text>
  <text class="text" x="390" y="405" text-anchor="middle">CoT-specific replacements</text>
  
  <line class="arrow" x1="290" y1="390" x2="250" y2="390"/>
  
  <!-- Step 8 -->
  <rect class="highlight" x="50" y="360" width="200" height="60" rx="5"/>
  <text class="text" x="150" y="385" text-anchor="middle" font-weight="bold">8. Transform CoT</text>
  <text class="text" x="150" y="405" text-anchor="middle">Safe CoT â†’ Mirage CoT</text>
  
  <line class="arrow" x1="150" y1="420" x2="150" y2="460"/>
  
  <!-- Step 9 -->
  <rect class="highlight" x="50" y="460" width="240" height="60" rx="5"/>
  <text class="text" x="170" y="485" text-anchor="middle" font-weight="bold">9. CoT Mirage Hack</text>
  <text class="text" x="170" y="505" text-anchor="middle" font-size="13">Input harmful prompt + mirage CoT</text>
  
  <line class="arrow" x1="290" y1="490" x2="330" y2="490"/>
  
  <!-- Step 10 -->
  <rect class="box" x="330" y="460" width="200" height="60" rx="5"/>
  <text class="text" x="430" y="485" text-anchor="middle" font-weight="bold">10. Evaluate</text>
  <text class="text" x="430" y="505" text-anchor="middle">Judge checks if harmful</text>
  
  <!-- Retry loop -->
  <path class="arrow" d="M 430 520 Q 430 560, 170 560 Q 50 560, 50 490" stroke-dasharray="5,3"/>
  <text class="text" x="240" y="555" text-anchor="middle" font-size="12">retry if refused</text>
  
  <!-- Output -->
  <line class="arrow" x1="530" y1="490" x2="570" y2="490"/>
  
  <rect class="note" x="570" y="460" width="200" height="60" rx="5"/>
  <text class="text" x="670" y="485" text-anchor="middle" font-weight="bold">Output</text>
  <text class="text" x="670" y="505" text-anchor="middle">Harmful response + score</text>
  
</svg>